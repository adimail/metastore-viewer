{% extends "base.html" %}
{% block title %}Bucket Explorer{% endblock %}

{% block content %}
<div class="container">
  <h1 class="text-3xl font-bold text-gray-800 mb-6">Bucket Explorer</h1>

  <!-- Bucket Metadata -->
  <div class="p-6 mb-6 bg-gray-100 ">
    <h2 class="text-2xl font-semibold text-gray-700">Workspace</h2>
    <div class="mt-4 grid grid-cols-2 gap-4 text-gray-600">
      <div><strong>Name:</strong> {{ bucket.name }}</div>
      <div><strong>Region:</strong> {{ bucket.region }}</div>
      <div><strong>Cloud:</strong> {{ bucket.cloud }}</div>
      <div><strong>Status:</strong> {{ bucket.status }}</div>
      <div><strong>Created On:</strong> {{ bucket.created_at.strftime('%Y-%m-%d') }}</div>
      <div><strong>Last Updated:</strong> {{ bucket.updated_on.strftime('%Y-%m-%d') }}</div>
    </div>
  </div>

  <!-- Bucket Contents (Tree Structure) -->
  <div class="p-6 bg-gray-100 ">
    <h2 class="text-2xl font-semibold text-gray-700">Bucket Contents</h2>
    
    {% if tables %}
      <ul class="mt-4 space-y-2">
        {% for table in tables %}
        <li>
          <details class="group">
            <summary class="cursor-pointer font-medium text-blue-600 group-open:text-blue-800">
              📁 {{ table.table_name }} ({{ table.table_format }})
            </summary>
            <ul class="ml-6 mt-2 space-y-2 text-gray-600">
              <li>📍 <strong>Path:</strong> {{ table.table_path }}</li>
              <li>📄 <strong>Metadata:</strong> {{ table.metadata_json[:100] }}...</li>
              <li>🕒 <strong>Last Updated:</strong> {{ table.last_updated.strftime('%Y-%m-%d %H:%M') }}</li>
            </ul>
          </details>
        </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-gray-500">No tables found in this workspace.</p>
    {% endif %}
  </div>
</div>
{% endblock %}
